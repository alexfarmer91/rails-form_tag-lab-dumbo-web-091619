# Rails form_tag Lab

## Objectives

1. Build a functional Rails form using a `form_tag`

2. Pass a route helper as the argument to a `form_tag`

3. Pass an options hash with a method to a `form_tag`

4. Use a `text_field_tag` and other form controls to create inputs

5. Build a `new` action that renders a form that submits to the `create` action


## Instructions

The two specs for this lab that are currently failing are located within the `form page` feature in `specs/features/student_spec.rb`.

For this lab, you need to build a form to create a new student, have the form redirect _back_ to the `new` view template (commonly, a `create` action would redirect to `index`), and print out the form params to the screen.  Below are a few items to keep in mind:

* Draw a `new` and `create` route for the `students` resource

* Print out the student value to the view template page


## Keys to remember

* Look at the tests to see which field values you should be using

* Make sure to use the `form_tag` helpers

```erb
<h3>Post Form</h3>

<form action="<%= posts_path %>" method="POST">
  <label>Post title:</label><br>
  <input type="text" id="post_title" name="post[title]"><br>

  <label>Post description:</label><br>
  <textarea id="post_description" name="post[description]"></textarea><br>

  <input type="submit" value="Submit Post">
</form>

<%= params.inspect %>
```


## Resources

* [Reading](https://github.com/learn-co-curriculum/rails-form_tag-readme)
* [Form Helper Documentation](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html)

<p data-visibility='hidden'>View <a href='https://learn.co/lessons/rails-form_tag-lab' title='Rails form_tag Lab'>Rails form_tag Lab</a> on Learn.co and start learning to code for free.</p>

To fix this `ActionController::InvalidAuthenticityToken` error, we can integrate
the `form_authenticity_token` helper into the form as a hidden field:

```erb
<form action="<%= posts_path %>" method="POST">
  <label>Post title:</label><br>
  <input type="text" id="post_title" name="post[title]"><br>

  <label>Post description:</label><br>
  <textarea id="post_description" name="post[description]"></textarea><br>

  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <input type="submit" value="Submit Post">
</form>
```

## Using form helpers

`ActionView`, a sub-gem of Rails, provides a number of helper methods to assist
with streamlining view template code. Specifically, we can use `ActionView`
methods to improve our form! Let's start by integrating a Rails `form_tag`
element:

```erb
<%= form_tag posts_path do %>
  <label>Post title:</label><br>
  <input type="text" id="post_title" name="post[title]"><br>

  <label>Post description:</label><br>
  <textarea id="post_description" name="post[description]"></textarea><br>

  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <input type="submit" value="Submit Post">
<% end %>
```

Next, we'll replace that hidden authenticity token input field with a Rails
`hidden_field_tag`:

```erb
<%= form_tag posts_path do %>

  ...

  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <input type="submit" value="Submit Post">
<% end %>
```

If we run the tests again, we'll see that they're all still passing. Let's take
a look at the HTML generated by our Rails `ActionView` methods:

```html
<form action="/posts" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="zkOjrjTG8Lxn0CF8Lt/kFIgWdYyY3NTMbwh+Q9kPX1NrYztgq0GZNCjLFavBXka1Y5QhNjDlhX+dzQoZMzUjOA==" />
  <label>Post title:</label><br>
  <input type="text" id="post_title" name="post[title]"><br>

  <label>Post description:</label><br>
  <textarea id="post_description" name="post[description]"></textarea><br>

  <input type="hidden" name="authenticity_token" id="authenticity_token" value="7SuubeJGbqfm4rO+F5VTS6Wl1SNCTGOr/mrYZKOQLbtICzajfcEHL6n5h2n4FPHqTieBmep1MhgMr6w+SapR0A==" />
  <input type="submit" value="Submit Post">
</form>
```

The `form_tag` Rails helper is smart enough to know that we want to submit the
form via the `POST` method, and it automatically renders the HTML that we were
writing by hand before. The `form_tag` method also automatically generates the
necessary authenticity token, so we can remove the now-redundant
`hidden_field_tag`.

Next, let's integrate some other form helpers to let Rails generate the input
elements for us. For this form, we'll be using a `text_field_tag` and a
`text_area_tag` and passing each the corresponding `name` attribute as a symbol.
It's important to keep in mind that form helpers aren't magic –– they're simply
Ruby methods that accept arguments, such as the `name` attribute and any
additional parameters related to the form's elements. In addition to updating
the form fields, we'll also replace the HTML tag for the submit button with a
`submit_tag`.

```erb
<%= form_tag posts_path do %>
  <label>Post title:</label><br>
  <%= text_field_tag :'post[title]' %><br>

  <label>Post description:</label><br>
  <%= text_area_tag :'post[description]' %><br>

  <%= submit_tag "Submit Post" %>
<% end %>
```

Let's check out the raw HTML all these helper methods generate for us:

```html
<form action="/posts" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="vq9SMVNk0CjwgZmYomFRhwbo5dfu7tI/2FiR7jOtlVgbj8r/zOO5oL+arU9N4PMm7WqxbUbXg4wqneW02ZfpMw==" />
  <label>Post title:</label><br>
  <input type="text" name="post[title]" id="post_title" /><br>

  <label>Post description:</label><br>
  <textarea name="post[description]" id="post_description">
</textarea><br>

  <input type="submit" name="commit" value="Submit Post" />
</form>
```

Run the spec tests one last time to verify that everything is still passing. You
now know how to build a Rails form from scratch and refactor it using Rails form
helper methods. Nice work!

[helpers]: https://learn.co/lessons/rails-url-helpers-readme

<p class='util--hide'>View <a href='https://learn.co/lessons/rails-form_tag-readme'>Rails form_tag</a> on Learn.co and start learning to code for free.</p>